<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.org.quoteservice.server.adapter.out.persistence.mapper.UserMapper">

  <resultMap id="UserResultMap" type="com.org.quoteservice.server.domain.model.User">
    <id property="id" column="id" />
    <result property="account" column="account" />
    <result property="password" column="password" />
    <result property="displayName" column="display_name" />
    <result property="createdAt" column="created_at" />
  </resultMap>

  <select id="findByAccount" parameterType="string" resultMap="UserResultMap">
    SELECT id,
           account,
           password,
           display_name,
           created_at
    FROM users
    WHERE account = #{account}
  </select>

  <select id="existsAccount" parameterType="string" resultType="boolean">
    SELECT EXISTS (
      SELECT 1
      FROM users
      WHERE account = #{account}
    )
  </select>

  <insert id="insert"
          parameterType="com.org.quoteservice.server.domain.model.User"
          useGeneratedKeys="true"
          keyProperty="id"
          keyColumn="id">
    INSERT INTO users (account, password, display_name)
    VALUES (#{account}, #{password}, #{displayName})
  </insert>

</mapper>
